# next-swarm.ps1 - Phase 13 -> Phase 14 Transition
# Generated by Claude-4 (Polish/Review) - v1.0.0 release agent
#
# Phase 13 FINAL State (v1.0.0 Release):
#   - Backend: 685 tests passing (50+ test files)
#   - Frontend: 480 tests passing (21 test files, 1 skipped)
#   - Total: 1165 tests, zero failures
#   - Build: 246KB main chunk, 15 lazy chunks, 41KB CSS
#   - Security: 0 CRITICAL, 0 HIGH, 0 pip-audit vulnerabilities
#   - Backend + Frontend versions bumped to 1.0.0
#
# Phase 13 Features:
#   - Full OpenAPI schema documentation (response models, summaries, error docs)
#   - 25 Pydantic response models (models/responses.py)
#   - ErrorDetail model for consistent JSON error structure
#   - Resource leak fix in _monitor_pid (try/finally on sqlite3)
#   - Dashboard toast stale closure fix
#   - AgentGrid + SignalPanel ARIA role="img" fixes (axe 4.11)
#   - CHANGELOG.md complete through v1.0.0
#
# Phase 14 Focus: Post-v1.0 Feature Enhancement
#   - Multi-project dashboard
#   - Swarm output intelligence
#   - Enhanced monitoring
#   - Claude-2 tasks carried from Phase 13 (vitest collection, a11y audit, responsive)

Write-Host ""
Write-Host "========================================" -ForegroundColor Cyan
Write-Host "  Phase 13 Complete -> Launching Phase 14" -ForegroundColor Cyan
Write-Host "========================================" -ForegroundColor Cyan
Write-Host ""
Write-Host "  Phase 13: v1.0.0 Release - ALL CRITERIA MET" -ForegroundColor Green
Write-Host "  1165 tests passing (685 backend + 480 frontend)" -ForegroundColor Green
Write-Host "  246KB main bundle, 0 security vulnerabilities" -ForegroundColor Green
Write-Host "  Full OpenAPI docs, Pydantic response models" -ForegroundColor Green
Write-Host ""
Write-Host "  Phase 14: Post-v1.0 Feature Enhancement" -ForegroundColor Yellow
Write-Host ""

# Generate Phase 14 task board
$phase14Tasks = @"
# Latent Underground - Task Board (Phase 14)

## Claude-1 [Backend/Core] - Multi-project and monitoring APIs

- [ ] Add multi-project status endpoint: GET /api/projects/dashboard (aggregated stats for all active projects)
- [ ] Add swarm output summarization: POST /api/swarm/output/{id}/summary (extract key events, errors, completions)
- [ ] Add project cloning: POST /api/projects/{id}/clone (deep copy with new name)
- [ ] Add batch operations: POST /api/projects/batch (archive/delete/export multiple projects)
- [ ] Signal: Create .claude/signals/backend-ready.signal

## Claude-2 [Frontend/Interface] - Multi-project dashboard and polish

- [ ] Fix vitest collection: ensure all 21 test files are collected by default (carried from Phase 13)
- [ ] Verify all components have aria-labels and keyboard navigation (carried from Phase 13)
- [ ] Final responsive check on narrow viewports (carried from Phase 13)
- [ ] Build multi-project dashboard: grid view showing all active projects with mini status cards
- [ ] Add project comparison view: side-by-side analytics for 2-3 projects
- [ ] Add PWA manifest for installable web app
- [ ] Signal: Create .claude/signals/frontend-ready.signal

## Claude-3 [Integration/Testing] - Comprehensive testing

- [ ] Add multi-project API tests (dashboard endpoint, batch operations)
- [ ] Add project clone tests (deep copy verification, config preservation)
- [ ] Add output summary tests
- [ ] Maintain 1100+ total tests, zero failures
- [ ] Signal: Create .claude/signals/tests-passing.signal

## Claude-4 [Polish/Review] - Quality and release

- [ ] Final code review of all Phase 14 changes
- [ ] Verify no regressions: all 1165+ tests still pass
- [ ] Security review of new endpoints
- [ ] Update CHANGELOG.md with Phase 14 features
- [ ] Verify production build remains under 300KB main chunk
- [ ] Prepare v1.1.0 release

## Completion Criteria
- [ ] Multi-project dashboard renders all active projects
- [ ] Project cloning creates accurate deep copy
- [ ] 1200+ total tests, zero failures
- [ ] Production build < 300KB main chunk
- [ ] No security vulnerabilities (CRITICAL or HIGH)
- [ ] CHANGELOG.md complete through Phase 14
"@

$phase14Tasks | Out-File -FilePath "tasks/TASKS.md" -Encoding UTF8
Write-Host "  Generated new tasks/TASKS.md for Phase 14" -ForegroundColor Green
Write-Host ""

# Relaunch swarm
Write-Host "  Relaunching swarm for Phase 14..." -ForegroundColor Yellow
& .\swarm.ps1 -Resume -NoConfirm -MaxPhases 24
